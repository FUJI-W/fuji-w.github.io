---
title: 「研究生考试」重点汇总篇
date: 2020-12-13 20:07:24
tags: 研究生考试
---



## 计算机组成原理

### 数据传输方式（I/O方式）

> 分类；各方式的原理、特点、适用情况；对比；

|       分类       | 原理                                                         | 特点                                                         | 其他                                                         |
| :--------------: | ------------------------------------------------------------ | :----------------------------------------------------------- | ------------------------------------------------------------ |
| **程序查询方式** | ①CPU执行初始化程序，预置参数；②CPU向I/O接口发出读指令；③CPU启动I/O设备后不断查询I/O设备状态，直到外设准备就绪；④从I/O接口读取字；⑤向存储器写入字；⑥循环直至读取完成； | ①CPU通过执行I/O指令直接完成I/O操作；②CPU与外设完全串行；     |                                                              |
|   **中断方式**   | ①~②同上；③外设准备阶段，CPU可以执行其他程序，当外设准备就绪后，发出中断请求，CPU中断正在执行的程序，处理I/O事务；④~⑥同上。 | ①CPU通过执行I/O指令直接完成I/O操作；②外设准备阶段，CPU与外设并行； | 适用场景：CPU控制，**低速设备**；                            |
|   **DMA方式**    | ①CPU初始化DMA控制器，设置数据传送方向、I/O接口地址、存储器起始地址、传送的数据数量、中断方式；②当接口做好数据传输的准备，向CPU发出DMA请求信号；③DMA控制器接到DMA应答之后，控制总线完成一次数据传送（周期窃取，单字传送）或 DMA控制器完全占用总线，进行多次DMA传送（成组传送）； ④DMA控制器完成所有的数据传送后，通过中断方式告知CPU；⑤CPU进行善后处理； | ①CPU仅在开始DMA操作之前和完成DMA操作之后参与I/O处理，在DMA过程中，CPU可以运行原来的程序；<br />②DMA总线与主存直接相连； | 停止CPU访问内存（成组传送方式）适用于**高速外设与存储器交换**数据的情况；周期窃取方式适用于**存储器速度远高于I/O设备速度**的情况； |
| **I/O通道方式**  | I/O模块成为有自主控制权的处理器，有处理I/O的专用指令集。CPU通过请求I/O通道执行存储器中的通道程序来启动一次I/O数据传送，I/O处理器不需要CPU干预就能获取并执行I/O指令。 | ①CPU完全解放，只需要指派，不需要执行；②通道程序存放在主存中； |                                                              |

### 总线仲裁方式

> 分类；各方式的原理、特点；对比；BS-总先忙信号，BR-总线请求信号；BG-总线响应信号

|                        |                             原理                             | 控制线数                                        | 优点                                       | 缺点                             |
| :--------------------: | :----------------------------------------------------------: | ----------------------------------------------- | ------------------------------------------ | -------------------------------- |
|    **链式查询方式**    | ![image-20201031203252165](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201031203252165.png) | `1+1+1`<br />BS-1, BR-1, BG-1                   | ①**优先级固定**；②结构简单，**扩充容易**； | ①对电路故障敏感；②优先级不灵活； |
| **计时器定时查询方式** | ![image-20201031204718480](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201031204718480.png) | `log(n)+1+1`<br />设备地址线-log(n), BS-1, BR-1 | ①**优先级较灵活**；                        | ①控制线较多；②控制复杂；         |
|    **独立请求方式**    | ![image-20201031210112631](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201031210112631.png) | `n+n+1`<br />BS-1, BR-n, BG-1                   | ①**优先级较灵活**；②**响应速度快**；       | ①控制线较多；②控制复杂；         |

### 总线性能指标

> 同步总线；总线时钟频率；总线带宽；总线数据传输率；突发传送；

| 指标               | 计算方法                                                     |
| ------------------ | ------------------------------------------------------------ |
| **同步总线**       | 收发双方使用同一时钟信号，与之相对的异步总线（按照时序的划分） |
| **总线时钟频率**   | 总线时钟周期的倒数，可以理解为1s有多少个时钟周期             |
| **总线数据传输率** | 总线每秒传输的数据量，单位通常为B/s                          |
| **总线带宽**       | 即总线的最大数据传输率，等于总线工作频率乘以总线宽度（总线位宽） |

- <details>
      <summary>例题</summary>
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/20201214162440.png"/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/20201214162316.png"/></pre>
  </details>

### 寻址方式

> 分类；各方式的特点、区别；

|                    |                            示意图                            |                             说明                             |            操作数             |
| :----------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :---------------------------: |
|    **立即寻址**    | ![image-20201020202344630](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202344630.png) | ![image-20201020202708944](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202708944.png) | 在**指令中**；需访存**0**次； |
| **寄存器直接寻址** | ![image-20201020202355521](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202355521.png) | ![image-20201020202721699](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202721699.png) | 在**寄存器**；需访存**0**次； |
|   寄存器间接寻址   | ![image-20201020202407657](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202407657.png) | ![image-20201020202733645](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202733645.png) | 在**存储器**；需访存**1**次； |
|    **基址寻址**    | ![image-20201020202416157](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202416157.png) | ![image-20201020202746061](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202746061.png) | 在**存储器**；需访存**1**次； |
|      变址寻址      | ![image-20201020202516488](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202516488.png) | ![image-20201020202755018](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202755018.png) | 在**存储器**；需访存**1**次； |
|    **相对寻址**    | ![image-20201020202523635](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202523635.png) | ![image-20201020202807345](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202807345.png) | 在**存储器**；需访存**1**次； |
|      堆栈寻址      | ![image-20201020203015603](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020203015603.png) | ![image-20201020202846921](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020202846921.png) | 在**存储器**；需访存**1**次； |

### Cache结构

> 不同的Cache组织形式下的 地址结构；与TLB结合的考查；Cache的实际容量、Cache命中率；

|                | 结构                                                         | 主存地址格式                                                 | 计算举例                                                     |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **全相联映射** | ![image-20201029195450679](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029195450679.png) | ![image-20201029175103598](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029175103598.png)<br />Tag 内容：与该 Cache 块 对应的主存块的 **块地址** | ![image-20201029175438241](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029175438241.png) |
| **直接映射**   | ![image-20201029195501839](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029195501839.png) | ![image-20201029175648900](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029175648900.png)<br />Tag 内容：主存中与该 Cache 数据块对应的数据块的 **区地址** | ![image-20201029175732008](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029175732008.png) |
| **组相联映射** | ![image-20201029195511288](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029195511288.png) | ![image-20201029180227277](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029180227277.png)<br />Tag 的内容：主存中与该 Cache 数据块对应的数据块的**组内块地址** | ![image-20201029180311014](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029180311014.png) |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029203720455.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029203804464.png"></pre></details>

| Cache替换策略      | 原则                                                     |
| ------------------ | -------------------------------------------------------- |
| 最近最少使用法 LRU | 记录每一个数据块的相对使用情况，最近没有被使用的块被替换 |
| 先进先出法 FIFO    | 最先装入数据的块被替换                                   |
| 最小使用频率法     | 记录每一个数据块的使用频率，使用次数最少的被替换         |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029205512573.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029205735502.png"><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029210323117.png"><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029210137818.png"><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029210229434.png"></pre></details>

- **Cache的实际容量**：`Cache的容量 + Cache中有效位和Tag所占空间`

  但如果不作特殊申明，**Cache的容量**指的是所有Cache**数据块**的总容量。

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201029212602374.png"/></pre></details>

- **TLB** 可以理解为数据块内容为**页表项**的Cache块，TLB一般采用全相联映射，但具体要看题目规定。

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030155106701.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030160021299.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030160333949.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030161448570.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030161604816.png"/></pre></details>

### 磁盘

> 盘面、磁道、扇区的概念；磁盘转速；磁盘容量、数据传输率的计算；与数据传输方式结合的考查；磁盘读写时间；

![image-20201214170318953](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214170318953.png)

| 指标             | 计算方法                                                     |
| ---------------- | ------------------------------------------------------------ |
| **存储容量**     | `盘面数（磁头数） × 每盘面的磁道数 × 每磁道的扇区数 × 扇区容量` |
| **寻道时间 **    | 磁头从当前位置定位到目标磁道所需时间（平均值）               |
| **寻区时间**     | 磁头定位到目标磁道后，等待目标扇区旋转到磁头下所需的时间（平均值） |
| **访问时间**     | `寻道时间 + 寻区时间`                                        |
| **平均存取时间** | `寻道时间 + 旋转延迟时间 + 传输时间（传输数据所花费的时间）` |
| **数据传输率**   | `磁盘转速（r转/秒） × 每条磁道的容量（N字节）`               |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201030174020868.png"/></details>

### CPU执行

> 影响计算机性能的因素；CPI、MIPS、CPU执行时间等指标的计算；

|              | 算法 | 程序设计语言 | 编译器 | 指令集体系结构 ISA | 硬件实现 |
| :----------: | :--: | :----------: | :----: | :----------------: | :------: |
|  **指令数**  |  ✓   |      ✓       |   ✓    |         ✓          |          |
|   **CPI**    |  ✓   |      ✓       |   ✓    |         ✓          |    ✓     |
| **时钟周期** |      |              |        |         ✓          |    ✓     |

|                                 | 计算方式                                                     | 含义                                                         |
| ------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **响应时间**                    | 从提交作业到完成作业所花费的时间                             | 响应时间是完成一个任务所花的时间总和，**个人用户更关心**     |
| **吞吐量**                      | 一定时间间隔内完成的作业数                                   | 多任务操作系统更侧重于优化系统的整体吞吐量，**企业级计算机的管理人员更关心** |
| **程序的CPU执行时间**           | ![image-20201214200826520](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214200826520.png) | 去除响应时间中因为等待 I/O 操作而花去的时间和 CPU 执行其他程序所花费的时间执行时间，是 **CPU 真正花在运行一个程序上的时间** |
| **程序的CPU时钟周期数**         | ![image-20201214200837112](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214200837112.png) | CPU 真正花在运行一个程序上的时钟周期数                       |
| **CPI**  指令平均执行时钟周期数 | ![image-20201214200446887](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214200446887.png) | 不同指令功能不同，所需时间也不同，CPI 只是某一机器中一个程序或程序片段每条指令所用时钟周期的平均值。**不同指令集的 CPI 比较没有实际意义**。 |
| **MIPS**  百万指令每秒          | ![image-20201214200253822](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214200253822.png) | **不同指令集的 MIPS 比较没有实际意义**                       |
| **MFLOPS**  百万浮点数操作每秒  | ![image-20201214200428293](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214200428293.png) | **可以比较不同机器的浮点运算能力** , 但有局限性；**MFLOPS 不仅和机器有关 , 也和所用测试程序有关，MFLOPS 与整数、浮点操作的比例有关** |

### MIPS处理器设计

> 计算不同设计下的时钟周期长度、执行指定指令所需时间、加速比；处理数据冒险；分析转发；

|              | 是什么？                               | 解决方法                                                     |
| ------------ | -------------------------------------- | ------------------------------------------------------------ |
| **结构冒险** | 数据通路组件使用的冲突                 | 在上升沿和下降沿分别进行写和读，并把读写端口分开；           |
| **数据冒险** | 需要等待上一条指令的结构               | 暂停；转发；                                                 |
| **控制冒险** | 下一条指令未知，或Branch和Jump的延迟槽 | 假定分支不发生；缩短分支延迟，即在ID阶段放置比较器，尽快得到B指令结果； |

### MIPS的几种常见指令的原理

> R指令、I指令、J指令的划分；add、addi、beq、jal、j、sw、lw 等的原理；

| 类型                     | 格式                                                         | 举例                                            |
| ------------------------ | ------------------------------------------------------------ | ----------------------------------------------- |
| **R 型指令(Register)**   | ![image-20201020212525677](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020212525677.png) | `add`, `addu`, `sub`, `subu`, `and`, `or`, `jr` |
| **I 型指令 (Immediate)** | ![image-20201020212612818](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020212612818.png) | `addi`, `ori`, `lui`, `lw`, `sw`, `beq`, `bnq`  |
| **J 型指令(Jump)**       | ![image-20201020212700024](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201020212700024.png) | `j`, `jal`                                      |

- **特殊指令**，如`syscall`(系统调用), `break`(断点)等都属于**R**类型指令；
- **跳转指令**，`j`, `jal`属于**J**类型指令；`jr`, `jalr`属于**R**型指令；

![image-20201214172501730](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214172501730.png)

- <font color="grey">注意 “指令语法” 与 “指令格式” 的不同：指令语法是程序员书写的语法规范，语法是固定的，用过约定好的规则使硬件实现更简单；而指令格式是指机器码(二进制代码)的格式</font>

### 分页系统

> 多级页表的原理；寻址过程；地址结构；

### 数制以及浮点数的计算

> 原码和补码的转换（定点数，包括整数和小数）；溢出的判断；IEEE754中浮点数的表示和计算步骤、规格化的概念；

### 存储器相关计算

> SRAM和DRAM的原理；存储器的扩展；DRAM相关的计算，如地址线数、行选择线数、数据线数；DRAM的刷新；

### 一些小名词

> 机器周期；指令周期；中断；中断请求触发器（INTR）；中断请求标记寄存器；中断服务子程序；中断隐指令；中断向量；中断向量表；中断屏蔽触发器；中断屏蔽字；总线时钟周期；总线工作周期；

- **机器周期与指令周期的辨析**

  <img src="https://gitee.com/FujiW/FigureBed/raw/master/img/20201214105229.png" style="zoom: 67%;" />

- **中断**的过程：①设备控制器或其他系统硬件发出中断；②处理器结束当前指令的执行；③处理器发出中断认可信号；④处理器将PC压入堆栈；⑤处理器获取中断向量，即PC值；⑥保存其余处理器的状态；⑦处理中断事务；⑧恢复处理器状态；⑨取回原PC，中断返回。

- **中断服务子程序**：即上述的⑥~⑨，是软件实现的。

  

------



## 操作系统

### 程序、进程和作业

> 三者的区别；联系；

|      | 特点                                                         | 构成                          |
| ---- | ------------------------------------------------------------ | ----------------------------- |
| 程序 | 静止的，是存放在磁盘上的可执行文件.                          | 代码                          |
| 进程 | 动态的，是一个程序对某个数据集的执行过程，是分配资源的基本单位。 | 程序、数据集合、进程控制块PCB |
| 作业 | 作业是用户需要计算机完成的某项任务，是要求计算机所做工作的集合 | 程序、数据、操作说明书        |

- **一个作业可划分为若干个进程来完成，而每一个进程有其实体——程序和数据集合**。

### 进程控制块

> PCB的作用；PCB包含哪些信息；

- PCB的作用：①进程创建、撤消；②进程唯一标志；③限制系统进程数目。

| 信息                 | 作用                                                         |
| -------------------- | ------------------------------------------------------------ |
| **进程标识符**       | 每个进程都必须有一个唯一的标识符；在进程创建时由系统赋予；   |
| **程序和数据的地址** | 把PCB与其程序和数据联系起来                                  |
| **当前状态**         | 为了管理的方便，系统设计时会将相同的状态的进程组成一个队列   |
| **现场保护区**       | 进程释放CPU时，要将CPU的各种状态信息保护起来，以便再运行时恢复 |
| **同步与同步机制**   | 用于实现进程间互斥、同步和通信所需的信号量等                 |
| **优先级**           | 进程的优先级反映进程的紧迫程序，通常由用户指定和系统设置     |
| **资源清单**         | 列出所拥有的除CPU外的资源记录，如**拥有的I/O设备**，**打开的文件列表**等 |
| **链接字**           | 根据进程所处的现行状态，PCB参加到不同队列中，链接字指出该进程所在队列中下一个进程PCB的首地址 |

### 进程状态的转换

> 转换的触发条件；各状态之间能否转换、怎么转换；

![image-20201108233428364](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201108233428364.png)

|                         就绪 → 运行                          |                         运行 → 就绪                          |                         运行 → 阻塞                          |                         阻塞 → 就绪                          |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| ![image-20201216205033027](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216205033027.png) | ![image-20201216205042949](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216205042949.png) | ![image-20201216205101701](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216205101701.png) | ![image-20201216205117209](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216205117209.png) |

- <font color="red">注意：无法直接实现 阻塞态⇥运行态，就绪态⇥阻塞态</font>

- <details> 
      <summary><i>挂起进程模型</i></summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201108235126919.png"/></pre></details>

### 作业调度策略

> 用不同的调度算法画出作业调度的过程；计算各种指标；

| 吞吐量                                  | 周转时间                                 | 带权周转时间                      |
| --------------------------------------- | ---------------------------------------- | --------------------------------- |
| `作业数 / 总执行时间`                   | `完成时间 - 提交时间`                    | `周转时间 / 服务时间（执行时间）` |
| **平均周转时间**                        | **平均带权周转时间**                     | **等待时间**                      |
| `一组作业周转时间之和 / 作业数`         | `一组作业带权周转时间之和 / 作业数`      | `周转时间 - 服务时间`             |
| **平均等待时间**                        | **响应时间**                             | **CPU利用率**                     |
| `一组作业等待被服务的时间之和 / 作业数` | `从用户提交请求到首次产生响应所用的时间` | `CPU忙碌的时间 / 总时间`          |

| 批处理系统的调度算法                                    | 算法详情                                                     | 饥饿  | 抢占  |
| ------------------------------------------------------- | ------------------------------------------------------------ | ----- | ----- |
| **先来先服务 FCFS**: First Come First Serve             | 最简单的调度算法，按先后顺序调度。                           |       |       |
| **最短作业优先 SJF**: Shortest Job First                | 对预期执行时间短的作业(进程)优先分派处理机；后来的短作业**不抢占**正在执行的作业。 | **✓** |       |
| **最短剩余时间优先 SRTN**: Shortest Remaining Time Next | 将短作业优先进行改进，改进为抢占式                           |       | **✓** |
| **最高响应比优先 HRRN**: Highest Response Ratio Next    | **响应比**：`1 + 等待时间/要求运行时间`<br />每当调度一个作业运行时，都要计算后备作业队列中每个作业的响应比，选择响应比最高者投入运行 |       |       |

<table>
    <tr>
        <th>交互式系统的调度算法</th>
        <th>算法流程</th>
    </tr>
    <tr>
        <td><b>时间片轮转 RR</b>: Round Robin</td>
        <td><details> 
            <summary><i></i></summary> 
            <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216212943488.png"/></pre>
        </details></td>
    </tr>
    <tr>
        <td><b>优先级调度</b> Priority Scheduling</td>
        <td><details> 
            <summary><i></i></summary> 
            <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216212750363.png"/></pre>
        </details></td>
    </tr>
    <tr>
        <td><b>多级队列 MQ</b>: Multi-level Queue</td>
        <td><details> 
            <summary><i></i></summary> 
            <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216212820041.png"/></pre>
        </details></td>
    </tr>
    <tr>
        <td><b>多级反馈队列 MFQ</b>: Multi-level Feedback Queue</td>
        <td><details> 
            <summary><i></i></summary> 
            <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216212921260.png"/></pre>
        </details></td>
    </tr>
</table>

- <details> 
      <summary>题目</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109202114329.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109202126859.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109202133520.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109202139221.png"/></pre></details>

- <details> 
      <summary>题目</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109210543395.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109210600468.png"/></pre></details>

### PV操作

> 定义；应用；同步关系和互斥关系的确定；详见 [「操作系统」02-进程管理](https://fujiw.gitee.io/2020/10/26/%E3%80%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%8D02-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/)

### 死锁

> 什么时候发生死锁？死锁的判断等；银行家算法；资源图；资源矩阵；详见 [「操作系统」02-进程管理](https://fujiw.gitee.io/2020/10/26/%E3%80%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%8D02-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/)

### 缺页中断

> 缺页中断的概念、触发和处理流程；

### 页面置换算法

> 用不同的置换算法计算 缺页次数、缺页率，画出页面置换过程；

![image-20201216220544861](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216220544861.png)

### 磁盘-缓冲区-用户区-CPU处理

> 计算系统的吞吐能力；环形缓冲区、缓冲池仅作了解；

|              | 特点                                                         | 原理图与时序图                                               |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **单缓冲区** | ![image-20201216220013715](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216220013715.png) | ![image-20201216220045766](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216220045766.png) |
| **双缓冲区** | ![image-20201216220025985](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216220025985.png) | ![image-20201216220052985](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216220052985.png) |

### 文件系统的结构

> 不同管理结构的原理、对比；最大容量；访问次数；

| 结构             | 原理                                                         | 目录项内容         | 随机访问 |
| ---------------- | ------------------------------------------------------------ | ------------------ | -------- |
| 顺序分配         | 为文件分配连续的磁盘块                                       | 起始块号，文件长度 | 支持     |
| 链接分配（隐式） | 每个盘块中存放指向下一个盘块的指针                           | 起始块号，结束块号 | 不支持   |
| 链接分配（显式） | 建立一张文件分配表FAT，记录盘块先后顺序<br />（开机后**FAT常驻内存**） | 起始块号           | 支持     |
| 索引分配（混合） | 为文件数据块建立索引表，类似页表                             | 顶级索引块的块号   | 支持     |

- **一个磁盘对应一张FAT；一个文件对应一个索引表**；

### 磁盘调度算法

> 各自的原理；主要是计算；

<img src="https://gitee.com/FujiW/FigureBed/raw/master/img/IMG_0864(20201214-163812).PNG" alt="IMG_0864(20201214-163812)" style="zoom: 67%;" />

### 廉价冗余磁盘阵列 RAID

> 不同阶段的对比；各自的特点；原理：利用冗余技术提高可靠性，利用并行提高性能；

![image-20201216201239923](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216201239923.png)

### 一些概念

> 简单记忆；列出表格的需要能够分辨并描述；

- **异常**(exception) = 陷阱(trap) + 中断(interrupt)

  - **中断**是异步异常，软件和硬件都可产生中断；**陷阱**是同步异常；**系统调用**看作同步异常
  - **陷阱帧**：线程描述表的子集，用于现场保护；**陷阱处理程序**：处理少量事件后移交给其他内核或执行体模块

- **进程通信的方式**：①共享存储；②管道通信；③消息传递；

- **进程控制块的组织形式**：①线性表；②链接方式；③索引方式；

- **线程的实现方式**：①用户级线程；②内核级线程；③混合线程（系统实现内核级线程，用户使用用户级线程）；

- **三级调度模型**：

  - ①高级调度（宏观调度、作业调度，用户工作流程角度，无→创建态→就绪态）；
  - ②中级调度（内外存调度，存储器资源角度，挂起态→就绪态）；
  - ③低级调度（微观调度、进程或线程调度，CPU资源角度，就绪态→运行态）；

- **进程的划分**：

  - 根据进程特性划分：①I/O密集型；②CPU密集型。
  - 根据是否在时钟中断作出调度决策：①非抢占式；②抢占式。
  - 根据不同的应用领域，优化目标不同：①批处理系统；②交互式系统；③实时系统。

- **同步机制应遵守的准则**：①空闲让进；②忙则等待；③有限等待；④让权等待；

- **(资源)死锁发生的四个必要条件**：①互斥条件；②保持和请求条件；③不剥夺条件；④环路等待条件；

- **死锁处理的四种方法**：

  - ①死锁检测与死锁恢复：**允许死锁发生**，当检测死锁发生后，采取措施恢复；死锁检测算法主要是检查是否有**循环等待**；

  - ②死锁预防：**静态**策略，破坏死锁的产生的四个条件之一：互斥、占有等待、不可抢占、环路等待；

  - ③死锁避免：**动态**策略，在每次**资源分配之前都要判断**是否安全，仅当安全时才进行分配。需要依赖执行前获取额外的信息；

  - <details> 
        <summary>银行家算法</summary> 
        <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201111203516611.png"/></pre></details>


|                    | 原因                                       | 需要保存                                                     |
| ------------------ | ------------------------------------------ | ------------------------------------------------------------ |
| **进程上下文切换** | 通常由调度器执行（Process Context Switch） | 保存进程执行断点；切换内存映射（页表基址、flush TLB）        |
| **陷入内核**       | 由中断、异常、Trap指令（系统调用）引起     | 保存执行现场（寄存器、堆栈等）                               |
| **系统调用**       | 进程从用户态到内核态的切换(mode switch)    | 主要是寄存器上下文的切换，比进程上下文切换的消耗要相对小很多 |

|          | 功能（特点）                                                 | 好处                                                         | 示意图                                                       | 拥有的资源                                             |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------ |
| **进程** | • 创建进程<br/>• 撤消进程<br/>• 进程切换                     | • 多个程序可以并发执行，改善资源使用率，提<br/>高系统效率    | ![image-20201109162354962](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109162354962.png) | 进程拥有 地址空间、全局变量、文件、信号、子进程信息。  |
| **线程** | • 进程中的一个实体<br/>• 内核级线程是CPU调度和分派的基本单位<br/>• 所有的线程共享其所属进程的所有资源与代码 | • 减少并发程序执行时所付出的时空开销，使得并发粒度更细、并发性更好 | ![image-20201109162414182](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109162414182.png) | 线程独立的资源：运行状态、程序计数器、执行栈，寄存器。 |

- 线程不能单独执行，但是每一个线程都有程序的入口、执行序列以及程序出口。它必须组成进程才能被执行。
- <font color="red">注意</font>：在**只有用户级线程的系统内，CPU调度还是以<u>进程</u>为单位**，处于运行状态的进程中的多个线程，由用户程序控制线程的轮换运行；在有**内核支持线程的系统内，CPU调度则以<u>线程</u>为单位**，由OS的线程调度程序负责线程的调度。

- <details> 
        <summary>对于多线程的web服务器实现，如果worker线程读取文件使用的是阻塞的读操作，那么你认为web服务器应该使用用户级线程还是内核级线程？</summary> 
        <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109173858046.png"/></pre></details>

- <details> 
        <summary>对于一个网络上的服务器，是否有一个应用场景，使用单线程比多线程要好？</summary> 
        <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109173934026.png"/></pre></details>

- <details> 
        <summary>一个多线程的进程fork的时候，子进程会复制父进程的所有线程。如果原来进程中多个线程中的一个在等待键盘输入，那么就会出现两个进程中各有一个线程等待输入的状态。请问，这个问题是否会出现在单线程执行的进程中？</summary> 
        <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201109174336675.png"/></pre></details>

- <details> 
      <summary>在多线程的场景下，优先级反转是否会发生在用户级线程的实现？为什么？</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201110102631446.png"/></pre></details>



------



## 计算机网络

### 网络分层模型

> ISO/OSI；TCP/IP；教学书籍；

|                  | 内容                                                         |
| ---------------- | ------------------------------------------------------------ |
| **ISO/OSI**      | 物理层 - 数据链路层 - 网络层 - 传输层 - 会话层 - 表示层 - 应用层 |
| **TCP/IP**       | 网络接口层                - 网际层 - 传输层 - 应用层         |
| **五层体系结构** | 物理层 - 数据链路层 - 网络层 - 传输层 - 应用层               |

### 物理层的若干设备

> 双绞线的应用、特点；光纤的分类、应用、特点；物理层的四个特性：电气、过程、机械、功能；

### 奈氏定理与香农定理

> 计算题；理想信道使用奈氏；信噪比使用香农；

|              | 内容                                                         | 内含                                                         |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **奈氏定理** | ![image-20201214212243918](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214212243918.png) | 在任何信道中，码元传输的速率是有上限的，否则就会出现**码间串扰**的问题，使接收端对码元的判决(即识别)成为不可能 |
| **香农定理** | ![image-20201214212255937](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214212255937.png) | 信道的带宽或信道中的**信噪比**越大，则信息的极限传输速率就越高 |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214212432061.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214212507796.png"/></details>

### 介质控制访问

> 信道划分介质访问控制：频分复用；时分复用；波分复用；码分多址；概念、特点；
>
> 随机访问介质访问控制：CSMA/CD（Carrier Sense Multiple Access with Collision Detection）；CSMA/CA；应用的协议、特点、对比；争用期，最短帧长等概念；

|             | 内容                                                         | 应用                                                         |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **CSMA/CD** | ① **载波监听**：“发送前先听”<br/>② **碰撞检测**：“边发送边听”<br/>③ **碰撞强化**：发送方检测到碰撞后，立即停止发送，并发送32或48bit的人为干扰信号，以便让所有用户都知道已经发生了碰撞<br/>④ **碰撞退避**：碰撞后，结点等待一段时间，重新开始载波检测和发送操作，为避免退避后再次碰撞，冲突各方的等待时间应各不相同 | ![image-20201214222806646](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214222806646.png)<br />以太网(有线) |
| **CSMA/CA** | ① **载波监听**：“发送前先听”<br/>② 接收端和发送端通过RTS/CTS **预约信道**<br />③ 接收端收到数据帧后，用**CRC检验**，正确则回复**ACK帧** | ![image-20201214223210599](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214223210599.png)<br />无线局域网 |

- 争用期（也称 碰撞窗口）：一个站点开始发送数据后，最多经过时间2τ(两倍的端-端时延)就可知道是否发生了碰撞；
- 以太网的争用期长度：51.2 us；
- ![image-20201214222738741](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214222738741.png)
- ![image-20201214222929371](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214222929371.png)
- IEEE802标准将局域网的数据链路层分为两个子层：LLC(Logic Link Control)逻辑链路控制子层；MAC(Media Access Control)介质访问控制子层。局域网对LLC子层透明。
- MAC地址：按照IEEE802.3标准，给每个结点分配唯一的MAC地址；MAC地址为**48 bit**，高24bit为厂商标识符，低24位由厂商自行分配，须保证每个网络接口具有**全球唯一的MAC地址**

### PPP协议

> 特点；可以实现什么，不可以实现什么；

| 帧格式                                                       | 各字段含义                                                   | 特点                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20201214221708650](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214221708650.png) | ![image-20201214221732792](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214221732792.png) | ![IMG_0866(20201214-221906)](https://gitee.com/FujiW/FigureBed/raw/master/img/IMG_0866(20201214-221906).PNG) |

### ARP协议

> 原理；特点；过程；IP地址 -> ARP -> 物理地址，物理地址 -> RARP -> IP地址；

| 第一步                                   | 第二步                                                       | 第三步                              | 第四步                                                       |
| ---------------------------------------- | ------------------------------------------------------------ | ----------------------------------- | ------------------------------------------------------------ |
| 先在其ARP高速缓存中查看有无主机B的IP地址 | 如有，就可查出其对应的硬件地址，再将此硬件地址写入MAC帧，通过局域网发送 | 如无，则在网络中**广播**一个ARP请求 | 当主机B收到ARP请求后，**向主机A返回一个ARP应答**，告知自己的<br/>物理地址 |

![image-20201215170811521](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215170811521.png)

- 注意：ARP解决**同一局域网**中的主机或路由器的IP 地址和硬件地址的映射问题，**如果目的主机不在本局域网内**，IP包需经由路由器转发，此时在局域网内要完成的是**路由器IP与物理地址**的映射，也就是最终会得到路由器的物理地址。

### IP协议

> IP数据报的各字段的含义和相关计算；分配IP，划分子网；特殊IP地址；IPv4与IPv6的对比；

![image-20201215172613614](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215172613614.png)

| 版本号 Version                                               | 首部长度 IHL                                                 | 总长度 Total length                                          |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| IP 协议的版本                                                | IP包头长度，最小为5，最大为15，单位为 **word**(32bit)。因此IP包头最长为60B。 | IP包总长度(含头部和数据)，单位为**字节**。因此IP包的最大长度为 65535 字节。 |
| **标识 Identification**                                      | **DF **Don't Fragment                                        | **MF **More Fragment                                         |
| 是一个计数器，用来产生IP包的标识，超过数据链路层MTU的IP包要分片传输；分片的多个包具有相同的标示，便于接收端重组。 | 当DF=0 时允许分片。                                          | MF=1表示后面“还有分片”；MF=0表示最后<br/>一个分片。          |
| **片偏移 Fragment offset**                                   | **生存时间 TTL **Time to live                                | **包头校验和 Header checksum**                               |
| 较长的包在分片后，某片在原分组中的相对位置，以**8字节**为单位 | IP包在网络中可通过的路由器个数的最大值。实际实现中，IP包每经过一个路由器TTL减1，为0则丢弃，并向源主机发送一个告警包。最大值为255，由源主机设定初始值。 | 包头校验和(注意：只针对包头)                                 |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215180509743.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215180528578.png"/></details>

- **IPv6**：**128位**地址，冒号十六进制记法；
- **IPv4/IPv6互操作**：①**双协议栈**；②**隧道技术**；

|             | 地址范围                | 地址格式                                                     | 私有地址                        |
| ----------- | ----------------------- | ------------------------------------------------------------ | ------------------------------- |
| **A类地址** | `1.x.x.x ~ 126.x.x.x`   | ![image-20201220214530606](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214530606.png) | `10.0.0.0 ~ 10.255.255.255`     |
| **B类地址** | `128.x.x.x ~ 191.x.x.x` | ![image-20201220214549009](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214549009.png) | `172.16.0.0 ~ 172.31.255.255 `  |
| **C类地址** | `192.x.x.x ~ 223.x.x.x` | ![image-20201220214557028](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214557028.png) | `192.168.0.0 ~ 192.168.255.255` |
| **D类地址** | `224.x.x.x ~ 239.x.x.x` | ![image-20201220214614956](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214614956.png) |                                 |
| **E类地址** | `240.x.x.x ~ 255.x.x.x` | ![image-20201220214606518](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214606518.png) |                                 |

![image-20201220214916610](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201220214916610.png)

### ICMP协议

> 作用；报文类型；全称 网际控制报文协议 Internet Control Message Protocol

- ICMP位于IP层，ICMP报文是封装在IP包中传输的

| 差错报文                               | 时机/作用                                                    |
| -------------------------------------- | ------------------------------------------------------------ |
| **终点不可达** Destination unreachable | 路由器或主机**无法传输**报文时，向源主机发送此报文           |
| **源点抑制** Source quench             | 路由器或主机由于**拥塞**丢弃报文时，向源主机发送此报文，使其放慢发送速度 |
| **超时** Time exceeded                 | 路由器收到**TTL字段为0**的报文时，向源主机发送此报文         |
| **参数问题** Parameter problem         | 路由器或主机收到的报文中**头部有非法字段**时，丢弃数据包，并向源主机发送此报文 |
| **重定向** Redirect                    | 路由器向主机发送此报文告知**路由改变**，主机下次发送数据报给另外的路由器 |

| 询问报文                               | 时机/作用          |
| -------------------------------------- | ------------------ |
| **回声探测** Echo request / reply      | 用于测试网络连通性 |
| **请求时间** Timestamp request / reply | 可用于时间同步     |

### 路由协议与路由表

> 给定网络拓扑图，填路由表；给若干路由表，反推网络拓扑；通信过程；

|                  | 特点                                                         | 适用情况                                                     |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 静态路由选择策略 | 非自适应路由选择；简单和开销较小，但不能及时适应网络状态的变化 | 适用于小规模且变化较少的网络，由人工设置路由                 |
| 动态路由选择策略 | 自适应路由选择；能较好地适应网络状态的变化，但实现起来较为复杂，开销也比较大 | 适用于较大规模、频繁变化的网络，通过专门的算法和协议进行路由的计算 |

|                      | 应用         | 要点                                                         | 特点                             |
| -------------------- | ------------ | ------------------------------------------------------------ | -------------------------------- |
| **距离向量路由算法** | **RIP**协议  | • RIP中距离定义为 路由器跳数，直接相连距离为0，最长距离为15，**距离为16表示不可达**；<br />• **按固定的时间间隔交换**路由信息(典型值：每隔30 秒)；<br />• **仅和相邻路由器交换信息**；<br/>• **交换**的信息是当前本路由器所知道的全部信息，即**自己的路由表**；<br/>• 使用**UDP协议**发送RIP分组 | 简单，适用于小规模网络中的路由   |
| **链路状态路由算法** | **OSPF**协议 | • 各路由器之间动态交换链路状态信息，**每个**路由器都建立一个链路状态数据库，链路状态数据库实际上是全网的拓扑结构图，它在**全网范围内是一致**的 (即链路状态数据库的同步)；<br />• 根据网络拓扑使用**Dijkstra算法**，构成路由表；<br />• **仅在链路状态发生变化时发送**洪泛信息；<br />• 洪泛: 结点收到分组时，**向除输入链路外的所有其他链路发送**出去；<br />• OSPF 不用UDP 而是**直接用IP 数据报**传送 | 收敛速度快，适用于较大规模的网络 |

- <details> 
      <summary>例题</summary> 
      <pre><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215210238743.png"/><br/><img src="https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215210401805.png"/></details>

### UDP协议

> 特点；注意UDP协议与TCP协议的区别；

- **无连接；可一对多、多对一、多对多、一对一；不可靠；无拥塞控制；首部开销小；面向报文**；
- 在IP的数据报服务之上，增加了 **端口**和**差错检测**；（IP只计算包头校验和，UDP计算整个数据报的校验和）

### TCP协议

> 可靠传输机制；拥塞控制机制；TCP数据报的各字段的含义和相关计算；

- **面向连接；只能点对点，即一对一；可靠，即无差错、不丢失、不重复、按序到达；面向字节流**；
- 应用程序以数据块为单位与TCP交互，但TCP将其视为无结构的字节流。结果：发送方应用进程发出的数据块与接收方应用进程收到的数据块**可能没有一一对应关系，但数据保证一致**。
- TCP连接是一条虚连接而不是一条真正的物理连接，TCP连接的端点不是主机，不是主机的IP地址，不是应用进程，也不是传输层的协议端口，TCP 连接的端点叫做套接字(socket)或插口

![image-20201215214838496](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215214838496.png)

| <font color="red">序号 Sequence number</font>                | <font color="red">确认号 Acknowledgement number</font> | <font color="red">数据偏移 Head length</font>                |
| ------------------------------------------------------------ | ------------------------------------------------------ | ------------------------------------------------------------ |
| 序号字段指本报文段所发送的数据的第一个字节的序号，以字节为单位 | 期望收到对方的下一个报文段的数据的第一个字节的序号     | TCP报文段的数据起始位置的偏移，也就是首部的长度，单位是 4B   |
| **紧急 URG**                                                 | <font color="red">**确认 ACK**</font>                  | **推送 PSH**                                                 |
| 为1时，紧急指针字段有效，表明有紧急数据，应尽快传送          | 为1时，确认号字段有效；为0时，确认号无效               | 为1时，接收方将尽快向应用进程交付此报文段，而不是等到整个缓存填满 |
| **复位 RST**                                                 | <font color="red">**同步 SYN**</font>                  | <font color="red">**终止 FIN**</font>                        |
| 为1时，表明TCP连接出现严重差错(如由于主机崩溃)，须释放连接后重新建立连接 | 为1时，表示这是一个连接请求或连接接受报文              | 为1时，表示要求释放TCP连接                                   |
| <font color="red">**窗口大小 Window Size**</font>            | **检验和 Checksum**                                    | **选项 Options**                                             |
| 用来让对方设置发送窗口的依据，单位为字节                     | 伪首部+首部+数据的校验和                               | 最大报文段长度MSS、窗口扩大选项、时间戳选项、选择确认选项等  |

- TCP基于**滑动窗口协议**实现可靠传输和流量控制，滑动窗口以**字节**为单位
  - 窗口大小的确定：对方发来的窗口大小、拥塞控制
  - 根据收到对方的TCP报文段头部中“acknowledge number”字段，窗口向前滑动
  - “acknowledge number”字段表示在此序号之前的数据已被正确接收

- TCP的可靠传输通过**校验和**+**超时重传**实现

![image-20201215222643699](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215222643699.png)

| TCP连接建立                                                  | TCP连接释放                                                  |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20201215223125960](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215223125960.png) | ![image-20201215223330799](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215223330799.png) |

- TCP 的连接释放时，关闭连接前等待2MSL时间的原因：为了保证A发送的最后一个ACK报文段能够到达B；防止“已失效的连接请求报文段”出现在本连接中，A在发送完最后一个ACK报文段后，再经过时间2MSL，就可以使本连接持续的时间内所产生的所有报文段，都从网络中消失；

### HTTP协议

> 客户/服务器方式；请求报文的方法；报文结构；特点；

- 应用层的许多协议都是基于客户/服务器方式；客户(client)和服务器(server)都是指通信中所涉及的两个应用进程；客户/服务器方式所描述的是进程之间服务和被服务的关系；
- HTTP---Hyper Text Transfer Protocol：**基于TCP协议**，**面向事务**的**客户/服务器协议**，**无状态的**；**面向正文的**(text-oriented)，**报文中的字段都是ASCII 码串**，因而**每个字段的长度都是不确定的**；
- **请求一个万维网文档所需的时间**：`文档传输时间 + 2倍RTT时间`
  - 建立TCP连接时3次握手的**第3次握手报文，可传送HTTP请求报文**，故只需2倍RTT时间；
- HTTP的报文类型：两类报文
  - 请求报文——从客户向服务器发送请求报文
  - 响应报文——从服务器到客户的回答

| HTTP请求报文                                                 | HTTP应答报文/响应报文                                        |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20201215224203304](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215224203304.png) | ![image-20201215224219576](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215224219576.png) |

![image-20201215224323445](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215224323445.png)

### 套接字

> 什么时候使用什么样的接口函数；

| 基于UDP的系统调用                                            | 基于TCP的系统调用                                            |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20201214224136289](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214224136289.png) | ![image-20201214224156123](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214224156123.png) |

### 域名系统DNS

| 本地域名服务器采用迭代查询                                   | 本地域名服务器采用递归查询(较少采用)                         | 实际应用场景                                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20201214224646987](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214224646987.png) | ![image-20201214224659559](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214224659559.png) | ![image-20201214224935777](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201214224935777.png) |

### 不同协议的对比

> 有无连接；是否可靠；哪一层的协议；

| 有连接                    | 无连接           | 可靠  | 不可靠 | 半双工 | 全双工    |
| ------------------------- | ---------------- | ----- | ------ | ------ | --------- |
| FTP；POP3；SMTP；TCP；PPP | ICMP；DNS；UDP； | TCP； | UDP；  |        | HDLC，TCP |

| 使用TCP协议                | 使用UDP协议    |
| -------------------------- | -------------- |
| FTP；POP3；SMTP；HTTP；BGP | ICMP；DNS；RIP |

- 网络层向传输层提供 - 数据的可靠传输是由网络负责的服务，是**虚电路**，这是面向连接的服务；可靠传输由**端系统**来负责，是**数据报**，这是**TCP/IP采用的**，**是无连接的服务**。

### 不同设备的对比

> 集线器；交换机；路由器；所在层，功能，能干什么，不能干什么

|                                     | 运行机制                                                     | 结构                                                         | 层         |
| ----------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------- |
| <font color="red">**路由器**</font> | ![image-20201215180327992](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215180327992.png) | ![image-20201215211443501](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201215211443501.png) | 网络层     |
| **交换机**                          | ①交换机是一种多接口网桥，早期称为交换式集线器(switching HUB)<br />②交换机按照自学习算法(self-learning)建立转发表，原理：若从A 发出的帧从接口x 进入了某网桥，那么从这个接口出发沿相反方向一定可把一个帧传送到A<br />③透明网桥还使用生成树算法，当多个局域网互连形成环路时，避免帧无休止转发 | ![image-20201216200151920](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216200151920.png) | 数据链路层 |
| **集线器**                          | ①中继器(repeater)或集线器(HUB)可实现局域网在物理层的互连<br />②可以方便地实现网络的扩展，且成本较低，但是碰撞域增大，碰撞发生概率增大，可能影响网络性能 | ![image-20201216200511519](https://gitee.com/FujiW/FigureBed/raw/master/img/image-20201216200511519.png) | 物理层     |

- 路由器内部的排队：在输入端口的处理时，网络层处理分组排队等待**查表和转发**；在输出端口处理时，网络层处理分组排队等待**缓存管理**；
- 路由器**不能**对收到的IP分组头进行差错校验，确保传输的IP分组不丢失；
- **交换机分隔冲突域，路由器分隔广播域**；

### 网络中的风险或故障

> 广播风暴；冲突 (碰撞)；超时；什么时候出现？出现在哪儿？为什么会出现？如何解决？

|                          | 现象/原因                                                    | 影响                                                | 解决                                                         |
| ------------------------ | ------------------------------------------------------------ | --------------------------------------------------- | ------------------------------------------------------------ |
| **广播风暴**             | 用网桥在数据链路层扩展局域网互连时，由于MAC 子层并没有流量控制功能，因而某些站点频繁发送广播帧会产生网络拥塞 | 网络拥塞                                            | 虚拟局域网VLAN，在现有局域网基础上，通过将网络站点分组，构成若干逻辑上独立的虚拟局域网，帧不会在两个VLAN之间自动转发，包括广播帧 |
| **TCP SYN Flooding攻击** | TCP建立连接时的三次握手带来的安全问题：攻击者连续发送大量SYN报文，但却不对SYN ACK报文做出响应 | 服务器内部数据结构满，无法响应正常用户的TCP连接请求 | 采用了SYN_Cookies机制                                        |

### 一些概念

> 一定要记忆；

- **协议数据单元(PDU)**：物理层是**位(Bit)**；数据链路层的是**帧(Frame)**；网络层是**分组(Packet)**；传输层是**数据段(Segment)**；

